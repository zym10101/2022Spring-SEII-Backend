# ERP灯具进销存系统详细设计描述文档

### 软工二大作业第15组

---

变更记录
---

| 变更人 | 变更时间 | 变更内容                                                     | 版本号 |
| ------ | -------- | ------------------------------------------------------------ | :----: |
| 张月明 | 2022.7.7 | 补充目录结构，补充引言                                       |  v1.0  |
| 张云菲 | 2022.7.8 | 增加付款单、收款单、工资单、销售明细用例用户界面层和业务逻辑层接口规范 |  v2.0  |
| 张月明 | 2022.7.8 | 增加促销策略、查看经营历程、查看经营情况、设置年终奖用户界面层和业务逻辑层接口规范 |  v3.0  |
| 张云菲 | 2022.7.9 | 增加账户管理用例用户界面层和业务逻辑层接口规范               |  v4.0  |
| 孙宇帆 | 2022.7.9 | 增加员工管理、员工打卡、薪酬制定用例用户界面层和业务逻辑层接口规范 |  v5.0  |
| 张云菲 | 2022.7.9 | 增加目录，增加部分顺序图、状态图                             |  v5.1  |

## 目录
<!-- TOC -->

- [1 引言](#1-引言)
  - [1.1 编制目的](#11-编制目的)
  - [1.2 词汇表](#12-词汇表)
  - [1.3 参考资料](#13-参考资料)
- [2 产品概述](#2-产品概述)
- [3 体系结构设计概述](#3-体系结构设计概述)
- [4 结构视角](#4-结构视角)
  - [4.1 业务逻辑层的分解](#41-业务逻辑层的分解)
    - [4.1.1 AccountBl模块](#411-AccountBl模块)
    - [4.1.2 PaySheetBl模块](#412-PaySheetBl模块)
    - [4.1.3 ReceiveSheetBl模块](#413-ReceiveSheetBl模块)
    - [4.1.4 WageSheetBl模块](#414-WageSheetBl模块)
    - [4.1.5 SaleBl模块（部分）](#415-SaleBl模块（部分）)
    - [4.1.6 PromotionBl模块](#416-PromotionBl模块)
    - [4.1.7 WarehouseBl模块](#417-WarehouseBl模块)
    - [4.1.8 FinancialBl模块](#418-FinancialBl模块)
    - [4.1.9 EmployeeBl模块](#419-EmployeeBl模块)
    - [4.1.10 AttendanceBl模块](#4110-AttendanceBl模块)
    - [4.1.11 EmployeePostBl模块](#4111-EmployeePostBl模块)
- [5 依赖视角](#5-依赖视角)

<!-- TOC -->

## 1 引言

### 1.1 编制目的

本报告详细完成对ERP灯具进销存系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。  
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。  

### 1.2 词汇表

| 词汇名称 | 词汇含义       | 备注 |
| -------- | -------------- | ---- |
| ERP      | 进销存管理系统 | 无   |

### 1.3 参考资料

*  IEEE标准
* 《软件工程与计算（卷二）软件开发的技术基础》 
* ERP灯具进销存系统用例文档
* ERP灯具进销存系统需求规格说明文档
* ERP灯具进销存系统体系结构设计文档 

## 2 产品概述

参考ERP灯具进销存系统用例文档和需求规格说明文档中对产品的概括描述。  

## 3 体系结构设计概述 

参考ERP灯具进销存系统体系结构设计文档中对体系结构设计的概述。

## 4 结构视角

### 4.1 业务逻辑层的分解

业务逻辑层的开发包图参见软件体系结构设计文档

#### 4.1.1 AccountBl模块

#### （1） 模块概述

AccountBl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求说明文档。  
AccountBl模块的职责及接口参见软件系统结构设计文档。  

#### （2） 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加AccountService接口。业务逻辑层和数据层之间添加AccountDao接口。为了隔离业务逻辑职责和逻辑控制职责，我们增加了AccountController，这样AccountController会对Account业务逻辑处理委托给AccountService对象。AccountPO是作为付款单的持久化对象添加到设计模型中去的。  

AccountBl模块各个类的职责如下表所示。

| 类                | 职责                                                         |
| ----------------- | ------------------------------------------------------------ |
| UserController    | 负责实现对应于登陆界面所需要的服务                           |
| AccountController | 负责实现账户管理界面所需要的服务                             |
| UserVO            | 系统用户对象，拥有用户数据的名称，角色和密码                 |
| AccountService    | 账户管理对象，拥有账户管理所持有的增删改查等行为，帮助完成账户管理界面所需要的服务 |

#### （3） 模块内部类的接口规范

##### 1 AccountController的接口规范

1.1 提供的服务（供接口）

| 服务名                                 | key      | value                                                        |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
| AccountController.<br/>accountRegister | 语法     | public Response accountRegister<br>(@RequestBody AccountVO accountVO) |
|                                        | 前置条件 | 已创建一个AccountService对象，并且VO符合条件                 |
|                                        | 后置条件 | 调用AccountService对象的registerAccount方法                  |
| AccountController.<br/>accountDrop     | 语法     | public Response accountDrop(@RequestParam String accountName) |
|                                        | 前置条件 | 已创建一个AccountService对象                                 |
|                                        | 后置条件 | 调用AccountService对象的dropAccount方法                      |
| AccountController.<br>accountUpdate    | 语法     | public Response accountUpdate<br>(@RequestParam String name, @RequestParam Integer id) |
|                                        | 前置条件 | 已创建一个AccountService对象，并且id存在于数据库中           |
|                                        | 后置条件 | 调用AccountService对象的updateAccount方法                    |
| AccountController.<br>queryAll         | 语法     | public Response queryAll()                                   |
|                                        | 前置条件 | 已创建一个AccountService对象                                 |
|                                        | 后置条件 | 调用AccountService对象的getAllAccount方法                    |
| AccountController.<br>queryByName      | 语法     | public Response queryByName(@RequestParam String name)       |
|                                        | 前置条件 | 已创建一个AccountService对象，并且输入合法                   |
|                                        | 后置条件 | 调用AccountService对象的findAccountByName方法                |

1.2 需要的服务（需接口）

| 服务名                                                | 服务                 |
| ----------------------------------------------------- | -------------------- |
| AccountService.registerAccount(AccountVO accountVO)   | 增加一个账户         |
| AccountService.dropAccount(String accountName)        | 删除一个账户         |
| AccountService.updateAccount(String name, Integer id) | 根据id更新账户名称   |
| AccountService.getAllAccount()                        | 返回所有账户列表     |
| AccountService.findAccountByName(String accountName)  | 根据名称模糊查询账户 |

##### 2 AccountService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                           | key      | value                                                  |
| -------------------------------- | -------- | ------------------------------------------------------ |
| AccountService.registerAccount   | 语法     | public void registerAccount(AccountVO accountVO)       |
|                                  | 前置条件 | accountVO属性齐全                                      |
|                                  | 后置条件 | 将处理后得到的PO存入数据库                             |
| AccountService.dropAccount       | 语法     | public void dropAccount(String accountName)            |
|                                  | 前置条件 | accountName存在于数据库中                              |
|                                  | 后置条件 | 更新数据库                                             |
| AccountService.updateAccount     | 语法     | public void updateAccount(String name, Integer id)     |
|                                  | 前置条件 | id存在且name合法                                       |
|                                  | 后置条件 | 更新id对应账户的名称                                   |
| AccountService.getAllAccount     | 语法     | public List<AccountPO> getAllAccount()                 |
|                                  | 前置条件 | 无                                                     |
|                                  | 后置条件 | 返回PO列表                                             |
| AccountService.findAccountByName | 语法     | public AccountPO findAccountByName(String accountName) |
|                                  | 前置条件 | accountName合法                                        |
|                                  | 后置条件 | 根据accountName返回符合条件的账户列表                  |

2.2 需要的服务（需接口）

| 服务名                                        | 服务                 |
| --------------------------------------------- | -------------------- |
| AccountDao.createAccount(AccountPO accountPO) | 增加一个账户         |
| AccountDao.deleteAccount(String name)         | 删除一个账户         |
| AccountDao.updateName(String name,Integer id) | 根据id更新账户名称   |
| AccountDao.findAll()                          | 返回所有账户列表     |
| AccountDao.findByName(String name)            | 根据名称模糊查询账户 |

#### （5） 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的对象。

#### 4.1.2 PaySheetBl模块

#### （1） 模块概述

PaySheetBl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求说明文档。  
PaySheetBl模块的职责及接口参见软件系统结构设计文档。  

#### （2） 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加PaySheetService接口。业务逻辑层和数据层之间添加PaySheetDao接口。为了隔离业务逻辑职责和逻辑控制职责，我们增加了PaySheetController，这样PaySheetController会对PaySheet业务逻辑处理委托给PaySheetService对象。PaySheetPO是作为付款单的持久化对象添加到设计模型中去的。  

PaySheetBl模块各个类的职责如下表所示。

| 类                 | 职责                                                         |
| ------------------ | ------------------------------------------------------------ |
| UserController     | 负责实现对应于登陆界面所需要的服务                           |
| PaySheetController | 负责实现付款单界面所需要的服务                               |
| UserVO             | 系统用户对象，拥有用户数据的名称，角色和密码                 |
| PaySheetService    | 付款单对象，拥有一张付款单所持有的制作、审批等行为，帮助完成付款单界面所需要的服务 |

#### （3） 模块内部类的接口规范

##### 1 PayController的接口规范

1.1 提供的服务（供接口）

| 服务名                              | key      | value                                                        |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
| PayController.<br/>makePaySheet     | 语法     | public Response makePaySheet<br>(UserVO userVO, @RequestBody PaySheetVO paySheetVO) |
|                                     | 前置条件 | 已创建一个PaySheetService对象，并且VO符合条件                |
|                                     | 后置条件 | 调用PaySheetService对象的makePaySheet方法                    |
| PayController.<br/>showSheetByState | 语法     | public Response showSheetByState<br>(@RequestParam(value = "state", required = false) PaySheetState state) |
|                                     | 前置条件 | 已创建一个PaySheetService对象，并且state存在于PaySheetState枚举中 |
|                                     | 后置条件 | 调用PaySheetService对象的getPaySheetByState方法              |
| PayController.approval              | 语法     | public Response approval<br>(@RequestParam("paySheetId") String paySheetId,  <br>@RequestParam("state") PaySheetState state) |
|                                     | 前置条件 | 已创建一个PaySheetService对象，paySheetId存在且state存在于PaySheetState枚举中 |
|                                     | 后置条件 | 调用PaySheetService对象的approval方法                        |

1.2 需要的服务（需接口）

| 服务名                                                       | 服务                     |
| ------------------------------------------------------------ | ------------------------ |
| PaySheetService.makePaySheet<br/>(UserVO userVO, PaySheetVO paySheetVO) | 制定一张付款单           |
| PaySheetService.getPaySheetByState<br>(PaySheetState state)  | 根据状态获取付款单       |
| PaySheetService.approval(String paySheetId, PaySheetState state) | 总经理审批id对应的付款单 |

##### 2 PaySheetService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                             | key      | value                                                        |
| ---------------------------------- | -------- | ------------------------------------------------------------ |
| PaySheetService.makePaySheet       | 语法     | public void makePaySheet(UserVO userVO, PaySheetVO paySheetVO) |
|                                    | 前置条件 | paySheetVO属性齐全                                           |
|                                    | 后置条件 | 将处理后得到的PO存入数据库                                   |
| PaySheetService.getPaySheetByState | 语法     | public List<PaySheetVO> getPaySheetByState(PaySheetState state) |
|                                    | 前置条件 | state存在于PaySheetState枚举中                               |
|                                    | 后置条件 | 根据state返回VO列表                                          |
| PaySheetService.approval           | 语法     | public void approval(String paySheetId, PaySheetState state) |
|                                    | 前置条件 | paySheetId存在且state存在于PaySheetState枚举中               |
|                                    | 后置条件 | 更新id对应单据的状态，更新客户应收金额，更新对应账户余额     |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                           |
| ------------------------------------------------------------ | ------------------------------ |
| PaySheetDao.getLatestSheet()                                 | 获取最近一条付款单             |
| PaySheetDao.saveSheet(PaySheetPO toSave)                     | 存入一条付款单记录             |
| PaySheetDao.saveBatchSheetContent(List<PaySheetContentPO> paySheetContent) | 把付款单上的具体内容存入数据库 |
| PaySheetDao.findAllSheet()                                   | 查找所有付款单                 |
| PaySheetDao.findAllByState(PaySheetState state)              | 根据state返回付款单            |
| PaySheetDao.findSheetById(String id)                         | 查找指定id的付款单             |
| PaySheetDao.findContentBySheetId(String sheetId)             | 查找指定付款单下具体的内容     |
| PaySheetDao.updateSheetState(String sheetId, PaySheetState state) | 更新指定付款单的状态           |
| PaySheetDao.updateSheetStateOnPrev(String sheetId, PaySheetState prev, PaySheetState state) | 根据当前状态更新付款单状态     |

#### （5） 业务逻辑层的设计原理

利用委托式控制风格，每个界面需要访问的业务逻辑由各自的控制器委托给不同的对象。

#### 4.1.3 ReceiveSheetBl模块

#### （1） 模块概述

ReceiveSheetBl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求说明文档。  
ReceiveSheetBl模块的职责及接口参见软件系统结构设计文档。  

#### （2） 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加ReceiveSheetService接口。业务逻辑层和数据层之间添加ReceiveSheetDao接口。为了隔离业务逻辑职责和逻辑控制职责，我们增加了ReceiveSheetController，这样ReceiveSheetController会对ReceiveSheet业务逻辑处理委托给ReceiveSheetService对象。ReceiveSheetPO是作为收款单的持久化对象添加到设计模型中去的。  

ReceiveSheetBl模块各个类的职责如下表所示。

| 类                 | 职责                                                         |
| ------------------ | ------------------------------------------------------------ |
| UserController     | 负责实现对应于登陆界面所需要的服务                           |
| ReceiveSheetController | 负责实现收款单界面所需要的服务                               |
| UserVO             | 系统用户对象，拥有用户数据的名称，角色和密码                 |
| ReceiveSheetService    | 收款单对象，拥有一张收款单所持有的制作、审批等行为，帮助完成收款单界面所需要的服务 |

#### （3） 模块内部类的接口规范

##### 1 ReceiveController的接口规范

1.1 提供的服务（供接口）

| 服务名                             | key      | value                                                        |
| ---------------------------------- | -------- | ------------------------------------------------------------ |
| ReceiveController.makeReceiveSheet | 语法     | public Response makeReceiveSheet(UserVO userVO, @RequestBody ReceiveSheetVO receiveSheetVO) |
|                                    | 前置条件 | 已创建一个ReceiveSheetService对象，并且VO符合条件            |
|                                    | 后置条件 | 调用ReceiveSheetService对象的makeReceiveSheet方法            |
| ReceiveController.showSheetByState | 语法     | public Response showSheetByState(@RequestParam(value = "state", required = false) ReceiveSheetState state) |
|                                    | 前置条件 | 已创建一个ReceiveSheetService对象，并且state存在于ReceiveSheetState枚举中 |
|                                    | 后置条件 | 调用ReceiveSheetService对象的getReceiveSheetByState方法      |
| ReceiveController.approval         | 语法     | public Response approval(@RequestParam("receiveSheetId") String receiveSheetId,  @RequestParam("state") ReceiveSheetState state) |
|                                    | 前置条件 | 已创建一个ReceiveSheetService对象，receiveSheetId存在且state存在于ReceiveSheetState枚举中 |
|                                    | 后置条件 | 调用ReceiveSheetService对象的approval方法                    |

1.2 需要的服务（需接口）

| 服务名                                                       | 服务                     |
| ------------------------------------------------------------ | ------------------------ |
| ReceiveSheetService.makeReceiveSheet(UserVO userVO, ReceiveSheetVO receiveSheetVO) | 制定一张收款单           |
| ReceiveSheetService.getReceiveSheetByState(ReceiveSheetState state) | 根据状态获取收款单       |
| ReceiveSheetService.approval(String receiveSheetId, ReceiveSheetState state) | 总经理审批id对应的收款单 |

##### 2 ReceiveSheetService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                                     | key      | value                                                        |
| ------------------------------------------ | -------- | ------------------------------------------------------------ |
| ReceiveSheetService.makeReceiveSheet       | 语法     | public void makeReceiveSheet(UserVO userVO, ReceiveSheetVO receiveSheetVO) |
|                                            | 前置条件 | receiveSheetVO属性齐全                                       |
|                                            | 后置条件 | 将处理后得到的PO存入数据库                                   |
| ReceiveSheetService.getReceiveSheetByState | 语法     | public List<ReceiveSheetVO> getReceiveSheetByState(ReceiveSheetState state) |
|                                            | 前置条件 | state存在于ReceiveSheetState枚举中                           |
|                                            | 后置条件 | 根据state返回VO列表                                          |
| ReceiveSheetService.approval               | 语法     | public void approval(String receiveSheetId, ReceiveSheetState state) |
|                                            | 前置条件 | receiveSheetId存在且state存在于ReceiveSheetState枚举中       |
|                                            | 后置条件 | 更新id对应单据的状态，更新客户应付金额，更新对应账户余额     |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                           |
| ------------------------------------------------------------ | ------------------------------ |
| ReceiveSheetDao.getLatestSheet()                             | 获取最近一条收款单             |
| ReceiveSheetDao.saveSheet(ReceiveSheetPO toSave)             | 存入一条收款单记录             |
| ReceiveSheetDao.saveBatchSheetContent(List<ReceiveSheetContentPO> receiveSheetContent) | 把收款单上的具体内容存入数据库 |
| ReceiveSheetDao.findAllSheet()                               | 查找所有收款单                 |
| ReceiveSheetDao.findAllByState(ReceiveSheetState state)      | 根据state返回收款单            |
| ReceiveSheetDao.findSheetById(String id)                     | 查找指定id的收款单             |
| ReceiveSheetDao.findContentBySheetId(String sheetId)         | 查找指定收款单下具体的内容     |
| ReceiveSheetDao.updateSheetState(String sheetId, ReceiveSheetState state) | 更新指定收款单的状态           |
| ReceiveSheetDao.updateSheetStateOnPrev(String sheetId, ReceiveSheetState prev, ReceiveSheetState state) | 根据当前状态更新收款单状态     |

#### 4.1.4 WageSheetBl模块

#### （1） 模块概述

WageSheetBl模块承担的需求参见需求规格说明文档功能需求及相关非功能需求说明文档。  
WageSheetBl模块的职责及接口参见软件系统结构设计文档。  

#### （2） 整体结构

根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们添加了接口。比如展示层和业务逻辑层之间，我们添加WageSheetService接口。业务逻辑层和数据层之间添加WageSheetDao接口。为了隔离业务逻辑职责和逻辑控制职责，我们增加了WageSheetController，这样WageSheetController会对WageSheet业务逻辑处理委托给WageSheetService对象。WageSheetPO是作为收款单的持久化对象添加到设计模型中去的。  

WageSheetBl模块各个类的职责如下表所示。

| 类                  | 职责                                                         |
| ------------------- | ------------------------------------------------------------ |
| UserController      | 负责实现对应于登陆界面所需要的服务                           |
| WageSheetController | 负责实现工资单界面所需要的服务                               |
| UserVO              | 系统用户对象，拥有用户数据的名称，角色和密码                 |
| WageSheetService    | 工资单对象，拥有一张工资单所持有的制作、审批等行为，帮助完成工资单界面所需要的服务 |

#### （3） 模块内部类的接口规范

##### 1 WageController的接口规范

1.1 提供的服务（供接口）

| 服务名                          | key      | value                                                        |
| ------------------------------- | -------- | ------------------------------------------------------------ |
| WageController.makeWageSheet    | 语法     | public Response makeWageSheet(UserVO userVO, @RequestBody WageSheetVO wageSheetVO) |
|                                 | 前置条件 | 已创建一个WageSheetService对象，并且VO符合条件               |
|                                 | 后置条件 | 调用WageSheetService对象的makeWageSheet方法                  |
| WageController.showSheetByState | 语法     | public Response showSheetByState(@RequestParam(value = "state", required = false) WageSheetState state) |
|                                 | 前置条件 | 已创建一个WageSheetService对象，并且state存在于WageSheetState枚举中 |
|                                 | 后置条件 | 调用WageSheetService对象的getWageSheetByState方法            |
| WageController.firstApproval    | 语法     | public Response firstApproval(@RequestParam("wageSheetId") String wageSheetId,  @RequestParam("state") WageSheetState state) |
|                                 | 前置条件 | 已创建一个WageSheetService对象，wageSheetId存在且state存在于WageSheetState枚举中 |
|                                 | 后置条件 | 调用WageSheetService对象的approval方法                       |
| WageController.approval         | 语法     | public Response approval(@RequestParam("wageSheetId") String wageSheetId, @RequestParam("state") WageSheetState state) |
|                                 | 前置条件 | 已创建一个WageSheetService对象，wageSheetId存在且state存在于WageSheetState枚举中 |
|                                 | 后置条件 | 调用WageSheetService对象的approval方法                       |
| WageController.getSalaryByTime  | 语法     | public Response getSalaryByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                 | 前置条件 | 开始时间小于结束时间                                         |
|                                 | 后置条件 | 调用WageSheetService对象的getSalaryByTime方法                |

1.2 需要的服务（需接口）

| 服务名                                                       | 服务                                     |
| ------------------------------------------------------------ | ---------------------------------------- |
| WageSheetService.makeWageSheet(UserVO userVO, WageSheetVO wageSheetVO) | 制定一张工资单                           |
| WageSheetService.getWageSheetByState(WageSheetState state)   | 根据状态获取工资单                       |
| WageSheetService.approval(String wageSheetId, WageSheetState state) | 人力资源人员或，总经理审批id对应的工资单 |
| WageSheetService.getSalaryByTime(String beginDateStr, String endDateStr) | 获取这段时间里的所有员工的工资总额       |

##### 2 WageSheetService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                                 | key      | value                                                        |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
| WageSheetService.makeWageSheet         | 语法     | public void makeWageSheet(UserVO userVO, WageSheetVO wageSheetVO) |
|                                        | 前置条件 | wageSheetVO属性齐全                                          |
|                                        | 后置条件 | 将处理后得到的PO存入数据库                                   |
| WageSheetService.getWageSheetByState   | 语法     | public List<WageSheetVO> getWageSheetByState(WageSheetState state) |
|                                        | 前置条件 | state存在于WageSheetState枚举中                              |
|                                        | 后置条件 | 根据state返回VO列表                                          |
| WageSheetService.approval              | 语法     | public void approval(String wageSheetId, WageSheetState state) |
|                                        | 前置条件 | wageSheetId存在且state存在于WageSheetState枚举中             |
|                                        | 后置条件 | 更新id对应单据的状态，更新对应账户余额                       |
| WageSheetService.getElevenMonthsSalary | 语法     | public BigDecimal getElevenMonthsSalary(Integer employeeId)  |
|                                        | 前置条件 | id存在于employee表中                                         |
|                                        | 后置条件 | 根据员工id返回对应前11个月的工资总和                         |
| WageSheetService.getSalaryByTime       | 语法     | public int getSalaryByTime(String beginDateStr, String endDateStr); |
|                                        | 前置条件 | 开始时间小于结束时间                                         |
|                                        | 后置条件 | 获取这段时间里的所有员工的工资总额                           |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                               |
| ------------------------------------------------------------ | ---------------------------------- |
| WageSheetDao.getLatestSheet()                                | 获取最近一条工资单                 |
| WageSheetDao.saveSheet(WageSheetPO toSave)                   | 存入一条工资单记录                 |
| WageSheetDao.findAllSheet()                                  | 查找所有工资单                     |
| WageSheetDao.findAllByState(WageSheetState state)            | 根据state返回工资单                |
| WageSheetDao.findSheetById(String id)                        | 查找指定id的工资单                 |
| WageSheetDao.updateSheetState(String sheetId, WageSheetState state) | 更新指定工资单的状态               |
| WageSheetDao.updateSheetStateOnPrev(String sheetId, WageSheetState prev, WageSheetState state) | 根据当前状态更新工资单状态         |
| WageSheetDao.getSalaryByTime(Date beginTime, Date endTime)   | 获取一段时间里的所有员工的工资总额 |

#### 4.1.5 SaleBl模块（部分）

#### （1）模块内部类的部分接口规范

##### 1 SaleController的接口规范

1.1 提供的服务（供接口）

| 服务名                                    | key      | value                                                        |
| ----------------------------------------- | -------- | ------------------------------------------------------------ |
| SaleController.getSaleIODetailByTime      | 语法     | public Response getSaleIODetailByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr, @RequestParam String productName, @RequestParam String customer, @RequestParam String salesman) throws ParseException |
|                                           | 前置条件 | 已创建一个SaleSheetService对象，并且输入符合条件             |
|                                           | 后置条件 | 调用SaleService对象的getSaleIODetailByTime方法               |
| SaleController.getIncomeByTime            | 语法     | public Response getIncomeByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                           | 前置条件 | 开始时间小于结束时间                                         |
|                                           | 后置条件 | 调用SaleService对象的getIncomeByTime方法                     |
| SaleController.getDiscountByTime          | 语法     | public Response getDiscountByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                           | 前置条件 | 开始时间小于结束时间                                         |
|                                           | 后置条件 | 调用SaleService对象的getDiscountByTime方法                   |
| SaleController.getVoucherByTime           | 语法     | public Response getVoucherByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                           | 前置条件 | 开始时间小于结束时间                                         |
|                                           | 后置条件 | 调用SaleService对象的getVoucherByTime方法                    |
| SaleController.getCostByTime              | 语法     | public Response getCostByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                           | 前置条件 | 开始时间小于结束时间                                         |
|                                           | 后置条件 | 调用SaleService对象的getCostByTime方法                       |
| SaleController.getSaleSheetIODetailByTime | 语法     | public Response getSaleSheetIODetailByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                           | 前置条件 | 开始时间小于结束时间                                         |
|                                           | 后置条件 | 调用SaleService对象的getSaleSheetIODetailByTime方法          |

1.2 需要的服务（需接口）

| 服务名                                                       | 服务                              |
| ------------------------------------------------------------ | --------------------------------- |
| SaleService.getSaleIODetailByTime(String beginDateStr,String endDateStr, String productName, String customer, String salesman) | 根据条件筛选得到销售明细表        |
| SaleService.getIncomeByTime(String beginDateStr, String endDateStr); | 获取这段时间里的销售总收入        |
| SaleService.getCostByTime(String beginDateStr, String endDateStr); | 获取这段时间里的销售成本          |
| SaleService.getDiscountByTime(String beginDateStr, String endDateStr); | 获取这段时间里的销售总折让        |
| SaleService.getVoucherByTime(String beginDateStr, String endDateStr); | 获取这段时间里的代金券总额        |
| SaleService.getSaleSheetIODetailByTime(String beginDateStr, String endDateStr); | 获取这段时间里的销售/销售退货单据 |

##### 2 SaleSheetService模块的部分接口规范

2.1 提供的服务（供接口）

| 服务名                               | key      | value                                                        |
| ------------------------------------ | -------- | ------------------------------------------------------------ |
| SaleSheet.getSaleIODetailByTime      | 语法     | public List<SaleIODetailPO> getSaleIODetailByTime(String beginDateStr, String endDateStr, String productName, String customer, String salesman); |
|                                      | 前置条件 | 参数以属性存在于数据库                                       |
|                                      | 后置条件 | 根据各个条件筛选得到PO列表并返回                             |
| SaleSheet.getIncomeByTime            | 语法     | public int getIncomeByTime(String beginDateStr, String endDateStr); |
|                                      | 前置条件 | 开始时间小于结束时间                                         |
|                                      | 后置条件 | 获取这段时间里的销售总收入                                   |
| SaleSheet.getCostByTime              | 语法     | public int getCostByTime(String beginDateStr, String endDateStr); |
|                                      | 前置条件 | 开始时间小于结束时间                                         |
|                                      | 后置条件 | 获取这段时间里的销售成本                                     |
| SaleSheet.getDiscountByTime          | 语法     | public int getDiscountByTime(String beginDateStr, String endDateStr); |
|                                      | 前置条件 | 开始时间小于结束时间                                         |
|                                      | 后置条件 | 获取这段时间里的销售总折让                                   |
| SaleSheet.getVoucherByTime           | 语法     | public int getVoucherByTime(String beginDateStr, String endDateStr); |
|                                      | 前置条件 | 开始时间小于结束时间                                         |
|                                      | 后置条件 | 获取这段时间里的代金券总额                                   |
| SaleSheet.getSaleSheetIODetailByTime | 语法     | List<SaleSheetIODetailPO> getSaleSheetIODetailByTime(String beginDateStr, String endDateStr); |
|                                      | 前置条件 | 开始时间小于结束时间                                         |
|                                      | 后置条件 | 获取这段时间里的销售/销售退货单据                            |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                                                      |
| ------------------------------------------------------------ | --------------------------------------------------------- |
| SaleSheetDao.getSaleIODetailByTime(Date beginTime, Date endTime, String productName, String customer, String salesman) | 查询指定时间区间，商品名，客户，业务员的销售/销售退货记录 |
| SaleSheetDao.getIncomeByTime(Date beginTime, Date endTime)   | 获取一段时间里的销售总收入                                |
| SaleSheetDao.getDiscountByTime(Date beginTime, Date endTime) | 获取一段时间里的销售总折让                                |
| SaleSheetDao.getVoucherByTime(Date beginTime, Date endTime)  | 获取一段时间里的代金券总额                                |
| SaleSheetDao.getCostByTime(Date beginTime, Date endTime)     | 获取一段时间里的销售成本                                  |
| SaleSheetDao.getSaleSheetIODetailByTime(Date beginTime, Date endTime) | 获取一段时间里的销售/销售退货单据                         |

#### （2）业务逻辑层的动态模型

查看经营历程表的正常流程描述的系统顺序图如下图所示。

![](https://pic.imgdb.cn/item/62c934cef54cd3f9379a2dc1.png)

查看经营情况表的正常流程描述的系统顺序图如下图所示。

![](https://pic.imgdb.cn/item/62c93ff7f54cd3f937abd112.png)

查看经营历程的状态图如下图所示。

![](https://pic.imgdb.cn/item/62c9404cf54cd3f937ac5b8b.png)

查看经营情况的状态图如下图所示。

![](https://pic.imgdb.cn/item/62c940e2f54cd3f937ad50bc.png)

#### 4.1.6 PromotionBl模块

#### （1）模块内部类的部分接口规范

##### 1 PromotionController的接口规范

1.1 提供的服务（供接口）

| 服务名                                             | key      | value                                                        |
| -------------------------------------------------- | -------- | ------------------------------------------------------------ |
| PromotionController.GetAllUserLevelPromotion       | 语法     | public Response GetAllUserLevelPromotion()                   |
|                                                    | 前置条件 | 无                                                           |
|                                                    | 后置条件 | 调用PromotionService对象的findLevelAll方法                   |
| PromotionController.UserLevelPromotion             | 语法     | public Response UserLevelPromotion(@RequestParam Integer userLevel, @RequestParam String giftName, @RequestParam BigDecimal discount, @RequestParam Integer voucher, @RequestParam String beginTime, @RequestParam String endTime) |
|                                                    | 前置条件 | 输入符合条件                                                 |
|                                                    | 后置条件 | 调用PromotionService对象的updateUserLevelPromotionByLevel方法 |
| PromotionController.GetAllTotalAmountPromotion     | 语法     | public Response GetAllTotalAmountPromotion()                 |
|                                                    | 前置条件 | 无                                                           |
|                                                    | 后置条件 | 调用PromotionService对象的findAmountAll方法                  |
| PromotionController.TotalAmountPromotion           | 语法     | public Response TotalAmountPromotion(@RequestParam Integer totalAmountMin, @RequestParam String giftName, @RequestParam Integer voucher, @RequestParam String beginTime, @RequestParam String endTime) |
|                                                    | 前置条件 | 输入符合条件                                                 |
|                                                    | 后置条件 | 调用PromotionService对象的updateTotalAmountPromotionByAmount方法 |
| PromotionController.addTotalAmountPromotion        | 语法     | public Response addTotalAmountPromotion(@RequestParam Integer totalAmountMin, @RequestParam String giftName, @RequestParam Integer voucher, @RequestParam String beginTime, @RequestParam String endTime) |
|                                                    | 前置条件 | 输入符合条件                                                 |
|                                                    | 后置条件 | 调用PromotionService对象的addTotalAmountPromotion方法        |
| PromotionController.deleteTotalAmountPromotionById | 语法     | public Response deleteTotalAmountPromotionById(@PathVariable Integer id) |
|                                                    | 前置条件 | 输入符合条件                                                 |
|                                                    | 后置条件 | 调用PromotionService对象的deleteTotalAmountPromotionById方法 |

##### 2 PromotionService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                                              | key      | value                                                        |
| --------------------------------------------------- | -------- | ------------------------------------------------------------ |
| PromotionService.findLevelAll                       | 语法     | public List<UserLevelPromotionPO> findLevelAll();            |
|                                                     | 前置条件 | 无                                                           |
|                                                     | 后置条件 | 返回UserLevelPromotionPO列表                                 |
| PromotionService.findOneByLevel                     | 语法     | public UserLevelPromotionPO findOneByLevel(Integer level);   |
|                                                     | 前置条件 | level在1-5之间                                               |
|                                                     | 后置条件 | 根据level返回PO                                              |
| PromotionService.updateUserLevelPromotionByLevel    | 语法     | public void updateUserLevelPromotionByLevel(UserLevelPromotionPO userLevelPromotionPO); |
|                                                     | 前置条件 | userLevelPromotionPO已存在                                   |
|                                                     | 后置条件 | 更新对应的userLevelPromotionPO                               |
| PromotionService.findAmountAll                      | 语法     | public List<TotalAmountPromotionPO> findAmountAll();         |
|                                                     | 前置条件 | 无                                                           |
|                                                     | 后置条件 | 返回TotalAmountPromotionPO列表                               |
| PromotionService.findOneByAmount                    | 语法     | public TotalAmountPromotionPO findOneByAmount(Integer amount); |
|                                                     | 前置条件 | amount已存在                                                 |
|                                                     | 后置条件 | 根据amount返回对应的TotalAmountPromotionPO                   |
| PromotionService.findAmountNumAll                   | 语法     | public List<Integer> findAmountNumAll();                     |
|                                                     | 前置条件 | 无                                                           |
|                                                     | 后置条件 | 返回所有总价促销策略的最低总价取值                           |
| PromotionService.updateTotalAmountPromotionByAmount | 语法     | public void updateTotalAmountPromotionByAmount(TotalAmountPromotionPO totalAmountPromotionPO); |
|                                                     | 前置条件 | totalAmountPromotionPO已存在                                 |
|                                                     | 后置条件 | 更新对应的totalAmountPromotionPO                             |
| PromotionService.deleteTotalAmountPromotionById     | 语法     | public void deleteTotalAmountPromotionById(Integer id);      |
|                                                     | 前置条件 | id已存在                                                     |
|                                                     | 后置条件 | 根据id删除对应的TotalAmountPromotionPO                       |
| PromotionService.addTotalAmountPromotion            | 语法     | public void addTotalAmountPromotion(TotalAmountPromotionPO totalAmountPromotionPO); |
|                                                     | 前置条件 | totalAmountPromotionPO不存在                                 |
|                                                     | 后置条件 | 将totalAmountPromotionPO添加入数据库中                       |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                               |
| ------------------------------------------------------------ | ---------------------------------- |
| PromotionDao.findLevelAll()                                  | 查找所有用户等级促销策略           |
| PromotionDao.findOneByLevel(Integer userLevel);              | 根据用户等级查找促销策略           |
| PromotionDao.updateUserLevelPromotionByLevel(UserLevelPromotionPO userLevelPromotionPO); | 更新用户等级促销策略               |
| PromotionDao.findAmountAll();                                | 查找所有总价促销策略               |
| PromotionDao.findOneByAmount(Integer amount);                | 根据总价查找促销策略               |
| PromotionDao.findAmountNumAll();                             | 查找所有总价促销策略的最低总价取值 |
| PromotionDao.updateSheetStateOnPrev(String sheetId, WageSheetState prev, WageSheetState state) | 更新总价促销策略                   |
| PromotionDao.deleteTotalAmountPromotionById(Integer id);     | 根据id删除总价促销策略             |
| PromotionDao.addTotalAmountPromotion(TotalAmountPromotionPO totalAmountPromotionPO); | 增加一条总价促销策略               |

#### （2）业务逻辑层的动态模型

制定促销策略的正常流程描述的系统顺序图如下图所示。

![](https://pic.imgdb.cn/item/62c94129f54cd3f937adc367.png)

制定促销策略的状态图如下图所示。

![](https://pic.imgdb.cn/item/62c9415bf54cd3f937ae175e.png)

#### 4.1.7 WarehouseBl模块

#### （1）模块内部类的部分接口规范

##### 1 WarehouseController的接口规范

1.1 提供的服务（供接口）

| 服务名                                                | key      | value                                                        |
| ----------------------------------------------------- | -------- | ------------------------------------------------------------ |
| WarehouseController.getWarehouseSpecialIODetailByTime | 语法     | public Response getWarehouseSpecialIODetailByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) throws ParseException |
|                                                       | 前置条件 | 输入符合条件                                                 |
|                                                       | 后置条件 | 调用WarehouseService对象的getWarehouseSpecialIODetailByTime方法 |
| WarehouseController.getWarehousePresent               | 语法     | public Response getWarehousePresent()                        |
|                                                       | 前置条件 | 无                                                           |
|                                                       | 后置条件 | 调用WarehouseService对象的getWarehousePresent方法            |
| WarehouseController.getWarehouseOverflow              | 语法     | public Response getWarehouseOverflow()                       |
|                                                       | 前置条件 | 无                                                           |
|                                                       | 后置条件 | 调用WarehouseService对象的getWarehouseOverflow方法           |
| WarehouseController.getWarehouseLoss                  | 语法     | public Response getWarehouseLoss()                           |
|                                                       | 前置条件 | 无                                                           |
|                                                       | 后置条件 | 调用WarehouseService对象的getWarehouseLoss方法               |
| WarehouseController.getOverflowByTime                 | 语法     | public Response getOverflowByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) |
|                                                       | 前置条件 | 输入符合条件                                                 |
|                                                       | 后置条件 | 调用WarehouseService对象的getOverflowByTime方法              |
| WarehouseController.getLossByTime                     | 语法     | public Response getLossByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) |
|                                                       | 前置条件 | 输入符合条件                                                 |
|                                                       | 后置条件 | 调用WarehouseService对象的getLossByTime方法                  |
| WarehouseController.getPresentByTime                  | 语法     | public Response getPresentByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) |
|                                                       | 前置条件 | 输入符合条件                                                 |
|                                                       | 后置条件 | 调用WarehouseService对象的getPresentByTime方法               |

##### 2 WarehouseService模块的部分接口规范

2.1 提供的服务（供接口）

| 服务名                                             | key      | value                                                        |
| -------------------------------------------------- | -------- | ------------------------------------------------------------ |
| WarehouseService.getWarehousePresent               | 语法     | public List<WarehouseZSDPO> getWarehousePresent();           |
|                                                    | 前置条件 | 无                                                           |
|                                                    | 后置条件 | 返回WarehouseZSDPO列表                                       |
| WarehouseService.getWarehouseOverflow              | 语法     | public List<WarehouseBYDPO> getWarehouseOverflow();          |
|                                                    | 前置条件 | 无                                                           |
|                                                    | 后置条件 | 返回WarehouseBYDPO列表                                       |
| WarehouseService.getWarehouseLoss                  | 语法     | public List<WarehouseBSDPO> getWarehouseLoss();              |
|                                                    | 前置条件 | 无                                                           |
|                                                    | 后置条件 | 返回WarehouseBSDPO列表                                       |
| WarehouseService.getOverflowByTime                 | 语法     | public int getOverflowByTime(String beginDateStr, String endDateStr); |
|                                                    | 前置条件 | 开始时间小于结束时间                                         |
|                                                    | 后置条件 | 返回这段时间里的报溢总额                                     |
| WarehouseService.getLossByTime                     | 语法     | public int getLossByTime(String beginDateStr, String endDateStr); |
|                                                    | 前置条件 | 开始时间小于结束时间                                         |
|                                                    | 后置条件 | 返回这段时间里的报损总额                                     |
| WarehouseService.getPresentByTime                  | 语法     | public int getPresentByTime(String beginDateStr, String endDateStr); |
|                                                    | 前置条件 | 开始时间小于结束时间                                         |
|                                                    | 后置条件 | 返回这段时间里的赠送总额                                     |
| WarehouseService.getWarehouseSpecialIODetailByTime | 语法     | public List<WarehouseSpecialIODetailPO> getWarehouseSpecialIODetailByTime(String beginDateStr, String endDateStr); |
|                                                    | 前置条件 | 开始时间小于结束时间                                         |
|                                                    | 后置条件 | 返回此时间段内的报溢单/报损单/赠送单信息                     |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                                     |
| ------------------------------------------------------------ | ---------------------------------------- |
| WarehouseDao.getWarehousePresent()                           | 获取所有赠送单                           |
| WarehouseDao.getAllOverflow();                               | 获取所有报溢单                           |
| WarehouseDao.getAllLoss();                                   | 获取所有报损单                           |
| WarehouseDao.getOverflowByTime(Date beginTime, Date endTime); | 查看一段时间报溢总金额                   |
| WarehouseDao.getLossByTime(Date beginTime, Date endTime);    | 查看一段时间报损总金额                   |
| WarehouseDao.getPresentByTime(Date beginTime, Date endTime); | 查看一段时间赠送总金额                   |
| WarehouseInputSheetDao.getWarehouseSpecialIODetailByTime(Date beginTime, Date endTime); | 查询指定时间段内报溢单/报损单/赠送单信息 |

#### 4.1.8 FinancialBl模块

#### （1）模块内部类的部分接口规范

##### 1 FinancialController的接口规范

1.1 提供的服务（供接口）

| 服务名                                 | key      | value                                                        |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
| FinancialController.getPayReceiveSheet | 语法     | public Response getPayReceiveSheet(@RequestParam String beginDateStr, @RequestParam String endDateStr) |
|                                        | 前置条件 | 输入符合条件                                                 |
|                                        | 后置条件 | 调用FinancialService对象的getPayReceiveSheet方法             |
| FinancialController.getWageSheet       | 语法     | public Response getWageSheet(@RequestParam String beginDateStr, @RequestParam String endDateStr) |
|                                        | 前置条件 | 输入符合条件                                                 |
|                                        | 后置条件 | 调用FinancialService对象的getWageSheet方法                   |

##### 2 FinancialService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                              | key      | value                                                        |
| ----------------------------------- | -------- | ------------------------------------------------------------ |
| FinancialService.getPayReceiveSheet | 语法     | public List<PayReceiveSheetIODetailPO> getPayReceiveSheet(String beginDateStr, String endDateStr); |
|                                     | 前置条件 | 开始时间小于结束时间                                         |
|                                     | 后置条件 | 返回PayReceiveSheetIODetailPO集合                            |
| FinancialService.getWageSheet       | 语法     | public List<WageSheetPO> getWageSheet(String beginDateStr, String endDateStr); |
|                                     | 前置条件 | state存在于PaySheetState枚举中                               |
|                                     | 后置条件 | 返回WageSheetPO集合                                          |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务             |
| ------------------------------------------------------------ | ---------------- |
| FinancialSheetDao.getPayReceiveSheet(Date beginTime, Date endTime); | 获取所有收付款单 |
| FinancialSheetDao.getWageSheet(Date beginTime, Date endTime); | 获取所有工资单   |

#### 4.1.9 EmployeeBl模块

#### （1）模块内部类的部分接口规范

##### 1 EmployeeController的接口规范

1.1 提供的服务（供接口）

| 服务名                                     | key      | value                                                      |
| ------------------------------------------ | -------- | ---------------------------------------------------------- |
| EmployeeController.add                     | 语法     | public Response add(@RequestBody EmployeeVO employeeVO)    |
|                                            | 前置条件 | 输入符合条件                                               |
|                                            | 后置条件 | 调用EmployeeService对象的addEmployee方法                   |
| EmployeeController.update                  | 语法     | public Response update(@RequestBody EmployeePO employeePO) |
|                                            | 前置条件 | 输入符合条件                                               |
|                                            | 后置条件 | 调用EmployeeService对象的updateEmployee方法                |
| EmployeeController.delete                  | 语法     | public Response delete(@RequestParam Integer id)           |
|                                            | 前置条件 | 该id标记的记录存在                                         |
|                                            | 后置条件 | 调用EmployeeService对象的deleteEmployee方法                |
| EmployeeController.findById                | 语法     | public Response findById(@RequestParam Integer id)         |
|                                            | 前置条件 | 该id标记的记录存在                                         |
|                                            | 后置条件 | 调用EmployeeService对象的findEmployeeById方法              |
| EmployeeController.findAll                 | 语法     | public Response findAll()                                  |
|                                            | 前置条件 | 无                                                         |
|                                            | 后置条件 | 调用EmployeeService对象的findGeneralInfoUnion方法          |
| EmployeeController.findGeneralInfoUnion    | 语法     | public Response findGeneralInfoUnion()                     |
|                                            | 前置条件 | 无                                                         |
|                                            | 后置条件 | 调用EmployeeDao对象的findMonthlyInfoUnion方法              |
| EmployeeController.findGeneralInfoUnion    | 语法     | public Response findGeneralInfoUnion()                     |
|                                            | 前置条件 | 无                                                         |
|                                            | 后置条件 | 调用EmployeeDao对象的findGeneralInfoUnion方法              |
| EmployeeController.findMonthlyInfoUnion    | 语法     | public Response findMonthlyInfoUnion()                     |
|                                            | 前置条件 | 无                                                         |
|                                            | 后置条件 | 调用EmployeeDao对象的findMonthlyInfoUnion方法              |
| EmployeeController.findCommissionInfoUnion | 语法     | public Response findCommissionInfoUnion()                  |
|                                            |          | 无                                                         |
|                                            | 后置条件 | 调用EmployeeDao对象的findCommissionInfoUnion方法           |
| EmployeeController.findYearlyInfoUnion     | 语法     | public Response findYearlyInfoUnion()                      |
|                                            | 前置条件 | 无                                                         |
|                                            | 后置条件 | 调用EmployeeDao对象的findYearlyInfoUnion方法               |

##### 2 EmployeeService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                           | key      | value                                       |
| -------------------------------- | -------- | ------------------------------------------- |
| EmployeeService.addEmployee      | 语法     | void addEmployee(EmployeeVO employeeVO);    |
|                                  | 前置条件 | EmployeeVO对象属性齐全                      |
|                                  | 后置条件 | 处理后得到的EmployeePO存入数据库            |
| EmployeeService.updateEmployee   | 语法     | void updateEmployee(EmployeePO employeePO); |
|                                  | 前置条件 | 该id对应的信息记录已存在                    |
|                                  | 后置条件 | 修改数据库中该员工的基本信息                |
| EmployeeService.deleteEmployee   | 语法     | void deleteEmployee(Integer id);            |
|                                  | 前置条件 | 该id对应的信息记录已存在                    |
|                                  | 后置条件 | 删除数据库中该员工信息                      |
| EmployeeService.findEmployeeById | 语法     | EmployeePO findEmployeeById(Integer id);    |
|                                  | 前置条件 | 该id对应的信息记录已存在                    |
|                                  | 后置条件 | 返回该员工的所有信息                        |

2.2 需要的服务（需接口）

| 服务名                                                | 服务                               |
| ----------------------------------------------------- | ---------------------------------- |
| EmployeeDao.addEmployeeSql(EmployeePO employeePO);    | 添加一条员工信息                   |
| EmployeeDao.updateEmployeeSql(EmployeePO employeePO); | 更新指定员工的相关信息             |
| EmployeeDao.deleteEmployeeSql(Integer id);            | 删除指定员工的相关信息             |
| EmployeeDao.findEmployeeSql(Integer id);              | 根据员工编号查找指定员工的相关信息 |
| EmployeeDao.findAllEmployee();                        | 获取所有员工信息                   |
| EmployeeDao.findGeneralInfoUnion();                   | 获取基本表和岗位表内的员工信息     |
| EmployeeDao.findMonthlyInfoUnion();                   | 查找两张表内月薪制员工信息         |
| EmployeeDao.findYearlyInfoUnion();                    | 查找两张表内年薪制员工信息         |
| EmployeeDao.findCommissionInfoUnion();                | 查找两张表内提成制员工信息         |
| EmployeePostDao.findEmployeePostById(id);             | 查找员工职务信息                   |
| EmployeePostDao.deleteEmployeePostSql(id);            | 删除员工职务信息                   |
| EmployeePostDao.deleteMonthlyParaSql(id);             | 删除月薪参数某条记录               |
| EmployeePostDao.deleteBaseAndCommissionParaSql(id);   | 删除提成参数某条记录               |
| EmployeePostDao.deleteYearlyParaSql(id);              | 删除年薪参数某条记录               |
| WageService.getElevenMonthsSalary(id);                | 计算前11个月的累计薪资             |
| EmployeePostDao.getYearBonusSql(id);                  | 获取年终奖数额                     |

#### （2）业务逻辑层的动态模型

制定年终奖的正常流程描述的系统顺序图如下图所示。

![](https://pic.imgdb.cn/item/62c941d4f54cd3f937aeddc4.png)

制定年终奖的状态图如下图所示。

![](https://pic.imgdb.cn/item/62c94205f54cd3f937af3a26.png)

#### 4.1.10 AttendanceBl模块

#### （1）模块内部类的部分接口规范

##### 1 AttendancelController的接口规范

1.1 提供的服务（供接口）

| 服务名                                 | key      | value                                                        |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
| AttendancelController.add              | 语法     | public Response add(@RequestBody AttendanceVO attendanceVO)  |
|                                        | 前置条件 | 输入符合条件                                                 |
|                                        | 后置条件 | 调用attendanceService对象的clockIn方法                       |
| AttendancelController.findById         | 语法     | public Response findById(@RequestParam Integer employeeId)   |
|                                        | 前置条件 | 输入符合条件                                                 |
|                                        | 后置条件 | 调用attendanceService对象的findAttendanceRecord方法          |
| AttendancelController.findByTime       | 语法     | public Response findByTime(@RequestParam String beginDateStr, @RequestParam String endDateStr) |
|                                        | 前置条件 | 输入符合条件，开始时间小于结束时间                           |
|                                        | 后置条件 | 调用attendanceService对象的getAttendanceByTime方法           |
| AttendancelController.updateBaseSalary | 语法     | public Response updateBaseSalary(@RequestParam Integer employeeId) |
|                                        | 前置条件 | id标记的记录已存在                                           |
|                                        | 后置条件 | 调用attendanceService对象的updateBaseSalary方法              |

##### 2 AttendanceService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                                 | key      | value                                                        |
| -------------------------------------- | -------- | ------------------------------------------------------------ |
| AttendanceService.clockIn              | 语法     | void clockIn(AttendanceVO attendanceVO);                     |
|                                        | 前置条件 | AttendanceVO对象属性齐全                                     |
|                                        | 后置条件 | 处理后得到的AttendancePO存入数据库                           |
| AttendanceService.findAttendanceRecord | 语法     | List<AttendanceVO> findAttendanceRecord(Integer employeeId); |
|                                        | 前置条件 | 该id对应的信息记录已存在                                     |
|                                        | 后置条件 | 返回AttendanceVO列表                                         |
| AttendanceService.updateBaseSalary     | 语法     | void updateBaseSalary(Integer employeeId);                   |
|                                        | 前置条件 | 该id对应的信息记录已存在                                     |
|                                        | 后置条件 | 修改数据库中该员工对应的基本薪资                             |
| WarehouseService.getAttendanceByTime   | 语法     | List<EmployeeAttendanceIODetailPO> getAttendanceByTime(String beginDateStr, String endDateStr); |
|                                        | 前置条件 | 开始时间小于结束时间                                         |
|                                        | 后置条件 | 返回这段时间里所有员工的打卡记录                             |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                               |
| ------------------------------------------------------------ | ---------------------------------- |
| AttendanceDao.addAttendanceSql(AttendancePO attendancePO);   | 存入一条打卡记录                   |
| AttendanceDao.findAttendanceById(Integer employeeId);        | 查询指定员工的打卡记录             |
| AttendanceDao.findAttendanceByNo(Integer attendanceNo);      | 获取指定编号的考勤记录             |
| AttendanceDao.updateBaseSalaryMonthlySql(Integer employeeId); | 根据考勤情况修改月薪制基本工资     |
| AttendanceDao.updateBaseSalaryCommissionSql(Integer employeeId); | 根据考勤情况修改提成制基本工资     |
| AttendanceDao.findAttendanceByTime(Date beginTime, Date endTime); | 获取指定时间段内全部员工的考勤记录 |
| EmployeePostDao.findEmployeePostById(employeeId);            | 查询指定员工的岗位信息             |

#### （2）业务逻辑层的动态模型

员工打卡的正常流程描述的系统顺序图如下图所示。

![](https://pic.imgdb.cn/item/62c94243f54cd3f937af9833.png)

员工打卡的状态图如下图所示。

![](https://pic.imgdb.cn/item/62c94264f54cd3f937afca01.png)

#### 4.1.11 EmployeePostBl模块

#### （1）模块内部类的部分接口规范

##### 1 EmployeePostController的接口规范

1.1 提供的服务（供接口）

| 服务名                                          | key      | value                                                        |
| ----------------------------------------------- | -------- | ------------------------------------------------------------ |
| EmployeePostController.addYearBonus             | 语法     | public Response addYearBonus(@RequestParam Integer id, @RequestParam Integer yearBonus) |
|                                                 | 前置条件 | 输入符合条件                                                 |
|                                                 | 后置条件 | 调用EmployeePostService对象的setYearBonusResult方法          |
| EmployeePostController.add                      | 语法     | public Response add(@RequestBody EmployeePostVO employeePostVO) |
|                                                 | 前置条件 | 输入符合条件                                                 |
|                                                 | 后置条件 | 调用EmployeePostService对象的addEmployeePostInfo方法         |
| EmployeePostController.update                   | 语法     | public Response update(@RequestBody EmployeePostPO employeePostPO) |
|                                                 | 前置条件 | 输入符合条件                                                 |
|                                                 | 后置条件 | 调用EmployeePostService对象的updateEmployeePostInfo方法      |
| EmployeePostController.delete                   | 语法     | public Response delete(@RequestParam Integer id)             |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 调用EmployeePostService对象的deleteEmployeePostInfo方法      |
| EmployeePostController.findById                 | 语法     | public Response findById(@RequestParam Integer id)           |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 调用EmployeePostService对象的findEmployeePostInfoById方法    |
| EmployeePostController.addYearBonus             | 语法     | public Response addYearBonus(@RequestParam Integer id, @RequestParam Integer yearBonus) |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 调用EmployeePostService对象的setYearBonusResult方法          |
| EmployeePostController.calSalary                | 语法     | public Response calSalary(@RequestParam("beginTimeStr") String beginTimeStr,@RequestParam("endTimeStr") String endTimeStr,@RequestParam("id") Integer id) |
|                                                 | 前置条件 | 该id对应的信息记录已存在，输入符合条件，开始时间小于结束时间 |
|                                                 | 后置条件 | 调用EmployeePostService对象的calculateEmployeeSalary方法     |
| EmployeePostController.addMonthlyPayPara        | 语法     | public Response addMonthlyPayPara(@RequestBody MonthlyPayVO monthlyPayVO) |
|                                                 |          | 输入符合条件                                                 |
|                                                 | 后置条件 | 调用EmployeePostService对象的setMonthlyPara方法              |
| EmployeePostController.addBaseAndCommissionPara | 语法     | public Response addBaseAndCommissionPara(@RequestBody BaseAndCommissionVO baseAndCommissionVO) |
|                                                 | 前置条件 | 输入符合条件                                                 |
|                                                 | 后置条件 | 调用EmployeePostService对象的setBaseAndCommissionPara方法    |
| EmployeePostController.addYearlyPayPara         | 语法     | public Response addYearlyPayPara(@RequestBody YearlyPayVO yearlyPayVO) |
|                                                 | 前置条件 | 输入符合条件                                                 |
|                                                 | 后置条件 | 调用EmployeePostService对象的setYearlyPara方法               |
| EmployeePostController.updateM                  | 语法     | public Response updateM(@RequestBody MonthlyPayPO monthlyPayPO) |
|                                                 | 前置条件 | 该id对应的信息记录已存在，输入符合条件                       |
|                                                 | 后置条件 | 调用EmployeePostService对象的updateMonthlyPara方法           |
| EmployeePostController.updateB                  | 语法     | ublic Response updateB(@RequestBody BaseAndCommissionPO baseAndCommissionPO) |
|                                                 | 前置条件 | 该id对应的信息记录已存在，输入符合条件                       |
|                                                 | 后置条件 | 调用EmployeePostService对象的updateBaseAndCommissionPara方法 |
| EmployeePostController.updateY                  | 语法     | public Response updateY(@RequestBody YearlyPayPO yearlyPayPO) |
|                                                 | 前置条件 | 该id对应的信息记录已存在，输入符合条件                       |
|                                                 | 后置条件 | 调用EmployeePostService对象的updateYearlyPara方法            |

##### 2 EmployeePostService模块的接口规范

2.1 提供的服务（供接口）

| 服务名                                          | key      | value                                                        |
| ----------------------------------------------- | -------- | ------------------------------------------------------------ |
| EmployeePostService.addEmployeePostInfo         | 语法     | void addEmployeePostInfo(EmployeePostVO employeePostVO);     |
|                                                 | 前置条件 | EmployeePostVO对象属性齐全                                   |
|                                                 | 后置条件 | 处理后得到的EmployeePostPO存入数据库                         |
| EmployeePostService.updateEmployeePostInfo      | 语法     | void updateEmployeePostInfo(EmployeePostPO employeePostPO);  |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 修改数据库中该员工的岗位信息                                 |
| EmployeePostService.deleteEmployeePostInfo      | 语法     | void deleteEmployeePostInfo(Integer id);                     |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 删除数据库中该员工信息                                       |
| EmployeePostService.findEmployeePostInfoById    | 语法     | EmployeePostPO findEmployeePostInfoById(Integer id);         |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 返回该员工的所有岗位相关信息                                 |
| EmployeePostService.calculateEmployeeSalary     | 语法     | void calculateEmployeeSalary(String beginTimeStr, String endTimeStr,Integer id) |
|                                                 | 前置条件 | 开始时间小于结束时间                                         |
|                                                 | 后置条件 | 将某员工某月除税收外薪资插入表中                             |
| EmployeePostService.setYearBonusResult          | 语法     | void setYearBonusResult(Integer id,Integer yearBonus);       |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 在表中设置年终奖计算结果                                     |
| EmployeePostService.setMonthlyPara              | 语法     | void setMonthlyPara(MonthlyPayVO monthlyPayVO);              |
|                                                 | 前置条件 | MonthlyPayVO对象属性齐全                                     |
|                                                 | 后置条件 | 处理后得到的MonthlyPayPO存入数据库                           |
| EmployeePostService.setBaseAndCommissionPara    | 语法     | void setBaseAndCommissionPara(BaseAndCommissionVO baseAndCommissionVO); |
|                                                 | 前置条件 | BaseAndCommissionVO对象属性齐全                              |
|                                                 | 后置条件 | 处理后得到的BaseAndCommissionPO存入数据库                    |
| EmployeePostService.setYearlyPara               | 语法     | void setYearlyPara(YearlyPayVO yearlyPayVO);                 |
|                                                 | 前置条件 | YearlyPayVO对象属性齐全                                      |
|                                                 | 后置条件 | 处理后得到的YearlyPayPO存入数据库                            |
|                                                 | 后置条件 | 处理后得到的BaseAndCommissionPO存入数据库                    |
| EmployeePostService.updateMonthlyPara           | 语法     | void updateMonthlyPara(MonthlyPayPO monthlyPayPO);           |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 表中的月薪参数被修改                                         |
| EmployeePostService.updateBaseAndCommissionPara | 语法     | void updateBaseAndCommissionPara(BaseAndCommissionPO baseAndCommissionPO); |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 表中的提成制参数被修改                                       |
| EmployeePostService.updateYearlyPara            | 语法     | void updateYearlyPara(YearlyPayPO yearlyPayPO);              |
|                                                 | 前置条件 | 该id对应的信息记录已存在                                     |
|                                                 | 后置条件 | 表中的年薪制参数被修改                                       |

2.2 需要的服务（需接口）

| 服务名                                                       | 服务                                 |
| ------------------------------------------------------------ | ------------------------------------ |
| EmployeePostDao.addEmployeePostSql(EmployeePostPO employeePostPO); | 添加员工职务信息，不包括薪资计算结果 |
| EmployeePostDao.updateEmployeePostSql(EmployeePostPO employeePostPO); | 新员工职务信息                       |
| EmployeePostDao.deleteEmployeePostSql(Integer id);           | 删除员工职务信息                     |
| EmployeePostDao.findEmployeePostById(Integer id);            | 根据员工编号查找员工职务信息         |
| EmployeePostDao.setCalResultSql(Integer id,Integer salaryStrategyResult); | 设置薪资计算结果                     |
| EmployeePostDao.setYearBonusResultSql(Integer id,Integer yearBonus); | 设置年终奖计算结果                   |
| EmployeePostDao.getYearBonusSql(Integer id);                 | 获取年终奖计算结果                   |
| EmployeePostDao.setMonthlyParaSql(MonthlyPayPO monthlyPayPO); | 设置月薪参数                         |
| EmployeePostDao.setBaseAndCommissionParaSql(BaseAndCommissionPO baseAndCommissionPO); | 设置提成参数                         |
| EmployeePostDao.setYearlyParaSql(YearlyPayPO yearlyPayPO);   | 设置年薪制参数                       |
| EmployeePostDao.getMonthlyParaSql(Integer id);               | 查找月薪参数                         |
| EmployeePostDao.getBaseAndCommissionParaSql(Integer id);     | 查找提成参数                         |
| EmployeePostDao. getYearlyParaSql(Integer id);               | 查找年薪制参数                       |
| EmployeePostDao.updateMonthlyParaSql(MonthlyPayPO monthlyPayPO); | 修改月薪参数                         |
| EmployeePostDao.updateBaseAndCommissionParaSql(BaseAndCommissionPO baseAndCommissionPO); | 修改提成参数                         |
| EmployeePostDao.updateYearlyParaSql(YearlyPayPO yearlyPayPO); | 修改年薪制参数                       |
| EmployeePostDao.deleteMonthlyParaSql(Integer id);            | 删除月薪参数某条记录                 |
| EmployeePostDao.deleteBaseAndCommissionParaSql(Integer id);  | 删除提成参数某条记录                 |
| EmployeePostDao.deleteYearlyParaSql(Integer id);             | 删除年薪参数某条记录                 |
| EmployeePostDao.setActualSalesSql(Integer id,Integer actualSales); | 设置实际销售额                       |
| SalaryStrategyDao.getMonthlyInfo(Integer id);                | 根据id获取某员工薪资信息             |
| SalaryStrategyDao.getBaseAndCommissionInfo(Integer id);      | 根据id获取某员工薪资信息             |
| SalaryStrategyDao.getYearlyInfo(Integer id);                 | 根据id获取某员工薪资信息             |
| SaleSheetDao.getMonthlySales(Date beginTime, Date endTime, String salesName); | 根据指定时间区间和销售员查询销售金额 |
| SaleReturnsSheetDao.getMonthlyReturnSales(Date beginTime, Date endTime, String salesName); | 根据指定时间区间和销售员查询退货金额 |
| EmployeeDao.findEmployeeSql(Integer id);                     | 根据id获取某员工基本信息             |

下图表明了ERP系统中，当用户输入月薪制员工薪资后，薪资计算业务逻辑处理的相关对象之间的协作。

![](https://pic.imgdb.cn/item/62ca1ef9f54cd3f937a3001d.png)

## 5 依赖视角

下图分别是前端和后端各自的包之间的依赖关系

![](https://seec-homework.oss-cn-shanghai.aliyuncs.com/201250015_lab7_front.png)

![](https://pic.imgdb.cn/item/62c8d7b1f54cd3f9372575f6.png)
